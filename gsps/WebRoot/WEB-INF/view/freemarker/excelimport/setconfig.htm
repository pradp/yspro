<html>
  <head>
  	<base target="_self"/>
    <title>excel数据导入</title>
    
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="expires" content="0">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" type="text/css" href="${basePath}/resources/css/zxdk.css">
	
	<script type="text/javascript" src="${basePath}/resources/jquery/jquery-1.2.6.pack.js"></script>
	<script type="text/javascript" src="${basePath}/resources/js/zxdk.js"></script>
	<script language="JavaScript">
	jQuery(document).ready(function(){
		jQuery("input:text").attr("maxLength","5").attr("size","2").css("ime-mode","disabled");
		detailPageStyle();
	});
	
	function checkForm(){
		var excelfile=jQuery("#excelfile").val()+"";
		var readWhichSheet = jQuery("#readWhichSheet").val()+"";
		var startReadRowNum = jQuery("#startReadRowNum").val()+"";
		var endReadRowNum = jQuery("#endReadRowNum").val()+"";
		var startReadCellNum = jQuery("#startReadCellNum").val()+"";
		var endReadCellNum = jQuery("#endReadCellNum").val()+"";
		if(excelfile=="" ){
			alert("请选择要导入的Excel文件！");
			return false;
		}
		if(readWhichSheet==""|| parseInt(readWhichSheet)<1 || parseInt(readWhichSheet)>50){
			alert("请输入要导入的sheet页！");
			return false;
		}
		if(startReadRowNum=="" || endReadRowNum==""){
			alert("请输入要导入的行数！");
			return false;
		}
		if(startReadCellNum=="" || endReadCellNum==""){
			alert("请输入要导入的列数！");
			return false;
		}
		if( parseInt(startReadRowNum)<1){
			alert("输入的开始行数不能小于一！");
			return false;
		}
		if( parseInt(startReadCellNum)<1){
			alert("输入的开始列数不能小于一！");
			return false;
		}
		return true;
	}
	</script>
  </head>
  
  <body>
  <#include "../showerr.ftl" parse="true">
  <form method="post" enctype="multipart/form-data" onsubmit="return checkForm();">
  <table width="90%" border="0">
    <tr>
      <td align="right">&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="right">&nbsp;</td>
      <td>选择要导入的Excel文件：
        <label>
        <input id="excelfile" name="excelfile" type="file">
      </label></td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="right">&nbsp;</td>
      <td><label>
        要导入的sheet页： 
            <input id="readWhichSheet" type="text" name="excelOperate.readWhichSheet" value="1"/>
      </label></td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="right">&nbsp;</td>
      <td>从第几
        <label>
        <input id="startReadRowNum" type="text" name="excelOperate.startReadRowNum" value="1"/>
      行开始到第几
      <input id="endReadRowNum" type="text" name="excelOperate.endReadRowNum" value="10"/>
      行结束</label></td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="right">&nbsp;</td>
      <td>从第几
        <label>
        <input id="startReadCellNum" type="text" name="excelOperate.startReadCellNum" value="1">
        列开始到第几</label>
      <label>
      <input id="endReadCellNum" type="text" name="excelOperate.endReadCellNum" value="100">
      </label>
      列结束</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="right" height="80">&nbsp;</td>
      <td align="center"><input type="submit" value=" 导入 "> </td>
      <td>&nbsp;</td>
    </tr>
  </table>
  <input type="hidden" name="targetType" value="${targetType?if_exists}"/>
  </form>
  </body>
</html>
