var ysStyle_ImagesPath="resource/images/style1/";var ystreecheckboxname="ystreeCheckBoxName";var valueContainerId="nodeid";function nodeText_clicked(nodeid,clickIndex){}function Node(id,pid,name,checkboxValue,openNode,url,title,target,icon,iconOpen){this.id=id;this.pid=pid;this.name=name;this.checkboxValue=checkboxValue;this._io=openNode||false;this.url=url;this.title=title;this.target=target;this.icon=icon;this.iconOpen=iconOpen;this._is=false;this._ls=false;this._hc=false;this._ai=0;this._p;}function YsTree(objName){this.config={target:null,folderLinks:true,useSelection:true,useCookies:true,useLines:true,useIcons:true,useStatusText:false,closeSameLevel:false,inOrder:false,showCheckBox:false};this.icon={root:ysStyle_ImagesPath+'base.gif',folder:ysStyle_ImagesPath+'folder.gif',folderOpen:ysStyle_ImagesPath+'folderopen.gif',node:ysStyle_ImagesPath+'page.gif',empty:ysStyle_ImagesPath+'empty.gif',line:ysStyle_ImagesPath+'line.gif',join:ysStyle_ImagesPath+'join.gif',joinBottom:ysStyle_ImagesPath+'joinbottom.gif',plus:ysStyle_ImagesPath+'plus.gif',plusBottom:ysStyle_ImagesPath+'plusbottom.gif',minus:ysStyle_ImagesPath+'minus.gif',minusBottom:ysStyle_ImagesPath+'minusbottom.gif',nlPlus:ysStyle_ImagesPath+'nolines_plus.gif',nlMinus:ysStyle_ImagesPath+'nolines_minus.gif'};this.obj=objName;this.aNodes=[];this.aIndent=[];this.root=new Node('');this.selectedNode=null;this.selectedFound=false;this.completed=false;}YsTree.prototype.add=function(id,pid,name,checkboxValue,openNode,url,title,target,icon,iconOpen){this.aNodes[this.aNodes.length]=new Node(id,pid,name,checkboxValue,openNode,url,title,target,icon,iconOpen);}YsTree.prototype.openAll=function(){this.oAll(true);}YsTree.prototype.closeAll=function(){this.oAll(false);}YsTree.prototype.toString=function(){var str='<div class="ystree">\n';if(document.getElementById){if(this.config.useCookies)this.selectedNode=this.getSelected();str+=this.addNode(this.root);}elsestr+='Browser not supported.';str+='</div>';if(!this.selectedFound){this.selectedNode=null;}this.completed=true;return str;}YsTree.prototype.addNode=function(pNode){var str='';var n=0;if(this.config.inOrder)n=pNode._ai;for(n;n<this.aNodes.length;n++){if(this.aNodes[n].pid==pNode.id){var cn=this.aNodes[n];cn._p=pNode;cn._ai=n;this.setCS(cn);if(!cn.target&&this.config.target)cn.target=this.config.target;if(cn._hc&&!cn._io&&this.config.useCookies)cn._io=this.isOpen(cn.id);if(!this.config.folderLinks&&cn._hc)cn.url=null;if(this.config.useSelection&&cn.id==this.selectedNode&&!this.selectedFound){cn._is=true;this.selectedNode=n;this.selectedFound=true;}str+=this.node(cn,n);if(cn._ls)break;}}return str;}YsTree.prototype.node=function(node,nodeId){var str='<div class="ysTreeNode">'+this.indent(node,nodeId);if(this.config.useIcons){if(!node.icon)node.icon=(this.root.id==node.pid)?this.icon.root:((node._hc)?this.icon.folder:this.icon.node);if(!node.iconOpen)node.iconOpen=(node._hc)?this.icon.folderOpen:this.icon.node;if(this.root.id==node.pid){node.icon=this.icon.root;node.iconOpen=this.icon.root;}if(this.config.showCheckBox){var _checkboxValue_="";if(node.checkboxValue==null){_checkboxValue_=node.id;}else{_checkboxValue_=node.checkboxValue;}str+='<input type="checkbox" id="checkbox_'+node.id+'" name="'+ystreecheckboxname+'" value="'+_checkboxValue_+'" onclick="resetValue(this)"/>';}str+='<img id="i'+this.obj+nodeId+'" src="'+((node._io)?node.iconOpen:node.icon)+'" />';}if(node.url&&node.url.length>0){str+='<a id="node_'+node.id+'" class="'+((this.config.useSelection)?((node._is?'nodeSel':'node')):'node')+'" href="'+node.url+'"';if(node.title)str+=' title="'+node.title+'"';if(node.target)str+=' target="'+node.target+'"';if(this.config.useStatusText)str+=' onmouseover="window.status=\''+node.name+'\';return true;" onmouseout="window.status=\'\';return true;" ';if(this.config.useSelection&&((node._hc&&this.config.folderLinks)||!node._hc))str+=' onclick="javascript: '+this.obj+'.s('+nodeId+');"';str+='>';}else{if(this.config.showCheckBox){str+='<label for="checkbox_'+node.id+'" id="node_'+node.id+'" onclick="'+this.obj+'.s('+nodeId+');" class="node" style="cursor:pointer;">';}else{str+='<a id="node_'+node.id+'" href="javascript: '+this.obj+'.s('+nodeId+');" class="node">';}}str+=node.name;if(node.url&&node.url.length>0){str+='</a>';}else{if(this.config.showCheckBox){str+='</label>';}else{str+='</a>';}}str+='</div>';if(node._hc){str+='<div id="d'+this.obj+nodeId+'" class="clip" style="display:'+((this.root.id==node.pid||node._io)?'block':'none')+';">';str+=this.addNode(node);str+='</div>';}this.aIndent.pop();return str;}YsTree.prototype.indent=function(node,nodeId){var str='';if(this.root.id!=node.pid){for(var n=0;n<this.aIndent.length;n++)str+='<img src="'+((this.aIndent[n]==1&&this.config.useLines)?this.icon.line:this.icon.empty)+'" />';(node._ls)?this.aIndent.push(0):this.aIndent.push(1);if(node._hc){str+='<a href="javascript: '+this.obj+'.o('+nodeId+');"><img id="j'+this.obj+nodeId+'" src="';if(!this.config.useLines)str+=(node._io)?this.icon.nlMinus:this.icon.nlPlus;elsestr+=((node._io)?((node._ls&&this.config.useLines)?this.icon.minusBottom:this.icon.minus):((node._ls&&this.config.useLines)?this.icon.plusBottom:this.icon.plus));str+='" alt="" /></a>';}elsestr+='<img src="'+((this.config.useLines)?((node._ls)?this.icon.joinBottom:this.icon.join):this.icon.empty)+'" alt="" />';}return str;}YsTree.prototype.setCS=function(node){var lastId;for(var n=0;n<this.aNodes.length;n++){if(this.aNodes[n].pid==node.id)node._hc=true;if(this.aNodes[n].pid==node.pid)lastId=this.aNodes[n].id;}if(lastId==node.id)node._ls=true;}YsTree.prototype.getSelected=function(){var sn=this.getCookie('cs'+this.obj);return(sn)?sn:null;}YsTree.prototype.s=function(index){var cn=this.aNodes[index];nodeText_clicked(cn.id,index);if(!this.config.useSelection)return;if(cn._hc&&!this.config.folderLinks)return;if(this.selectedNode!=index){if(this.selectedNode||this.selectedNode==0){eOld=document.getElementById("node_"+this.aNodes[this.selectedNode].id);eOld.className="node";}eNew=document.getElementById("node_"+cn.id);eNew.className="nodeSel";this.selectedNode=index;if(this.config.useCookies)this.setCookie('cs'+this.obj,index);}}YsTree.prototype.o=function(index){var cn=this.aNodes[index];this.nodeStatus(!cn._io,index,cn._ls);cn._io=!cn._io;if(this.config.closeSameLevel)this.closeLevel(cn);if(this.config.useCookies)this.updateCookie();}YsTree.prototype.oAll=function(status){for(var n=0;n<this.aNodes.length;n++){if(this.aNodes[n]._hc&&this.aNodes[n].pid!=this.root.id){this.nodeStatus(status,n,this.aNodes[n]._ls)this.aNodes[n]._io=status;}}if(this.config.useCookies)this.updateCookie();}YsTree.prototype.openTo=function(nId,bSelect,bFirst){if(!bFirst){for(var n=0;n<this.aNodes.length;n++){if(this.aNodes[n].id==nId){nId=n;break;}}}var cn=this.aNodes[nId];if(cn.pid==this.root.id||!cn._p)return;cn._io=true;cn._is=bSelect;if(this.completed&&cn._hc)this.nodeStatus(true,cn._ai,cn._ls);if(this.completed&&bSelect)this.s(cn._ai);elseif(bSelect)this._sn=cn._ai;this.openTo(cn._p._ai,false,true);}YsTree.prototype.closeLevel=function(node){for(var n=0;n<this.aNodes.length;n++){if(this.aNodes[n].pid==node.pid&&this.aNodes[n].id!=node.id&&this.aNodes[n]._hc){this.nodeStatus(false,n,this.aNodes[n]._ls);this.aNodes[n]._io=false;this.closeAllChildren(this.aNodes[n]);}}}YsTree.prototype.closeAllChildren=function(node){for(var n=0;n<this.aNodes.length;n++){if(this.aNodes[n].pid==node.id&&this.aNodes[n]._hc){if(this.aNodes[n]._io)this.nodeStatus(false,n,this.aNodes[n]._ls);this.aNodes[n]._io=false;this.closeAllChildren(this.aNodes[n]);}}}YsTree.prototype.nodeStatus=function(status,id,bottom){eDiv=document.getElementById('d'+this.obj+id);eJoin=document.getElementById('j'+this.obj+id);if(this.config.useIcons){eIcon=document.getElementById('i'+this.obj+id);eIcon.src=(status)?this.aNodes[id].iconOpen:this.aNodes[id].icon;}eJoin.src=(this.config.useLines)?((status)?((bottom)?this.icon.minusBottom:this.icon.minus):((bottom)?this.icon.plusBottom:this.icon.plus)):((status)?this.icon.nlMinus:this.icon.nlPlus);eDiv.style.display=(status)?'block':'none';}YsTree.prototype.clearCookie=function(){var now=new Date();var yesterday=new Date(now.getTime()-1000*60*60*24);this.setCookie('co'+this.obj,'cookieValue',yesterday);this.setCookie('cs'+this.obj,'cookieValue',yesterday);}YsTree.prototype.setCookie=function(cookieName,cookieValue,expires,path,domain,secure){document.cookie=escape(cookieName)+'='+escape(cookieValue)+(expires?'; expires='+expires.toGMTString():'')+(path?'; path='+path:'')+(domain?'; domain='+domain:'')+(secure?'; secure':'');}YsTree.prototype.getCookie=function(cookieName){var cookieValue='';var posName=document.cookie.indexOf(escape(cookieName)+'=');if(posName!=-1){var posValue=posName+(escape(cookieName)+'=').length;var endPos=document.cookie.indexOf(';',posValue);if(endPos!=-1)cookieValue=unescape(document.cookie.substring(posValue,endPos));elsecookieValue=unescape(document.cookie.substring(posValue));}return(cookieValue);}YsTree.prototype.updateCookie=function(){var str='';for(var n=0;n<this.aNodes.length;n++){if(this.aNodes[n]._io&&this.aNodes[n].pid!=this.root.id){if(str)str+='.';str+=this.aNodes[n].id;}}this.setCookie('co'+this.obj,str);}YsTree.prototype.isOpen=function(id){var aOpen=this.getCookie('co'+this.obj).split('.');for(var n=0;n<aOpen.length;n++)if(aOpen[n]==id)return true;return false;}if(!Array.prototype.push){Array.prototype.push=function array_push(){for(var i=0;i<arguments.length;i++)this[this.length]=arguments[i];return this.length;}}if(!Array.prototype.pop){Array.prototype.pop=function array_pop(){lastElement=this[this.length-1];this.length=Math.max(this.length-1,0);return lastElement;}}if(!Array.prototype.remove){Array.prototype.remove=function(dx){if(isNaN(dx)||dx>this.length){return false;}this.splice(dx,1);}}YsTree.prototype.getNodeObjectById=function(nodeid){var arr=ystree.aNodes;for(var i=0;i<arr.length;i++){var node=arr[i];if(node.id==nodeid){return node;}}return null;}function resetValue(obj){selectAllSon(obj);var c=document.getElementsByName(ystreecheckboxname);var tmp="";for(var i=0;i<c.length;i++){if(c[i].checked){tmp+=c[i].value+",";}}tmp=tmp.substring(0,tmp.length-1);if(document.getElementById(valueContainerId))document.getElementById(valueContainerId).value=tmp;elseif(document.getElementsByName(valueContainerId)[0]){document.getElementsByName(valueContainerId)[0].value=tmp;}}function selectAllSon(obj){var checkedid=obj.id;var c=document.getElementsByName(ystreecheckboxname);for(var i=c.length-1;i>=0;i--){if(c[i].id==checkedid){}else if(c[i].id.indexOf(checkedid)==0){c[i].checked=obj.checked;}else if(checkedid.indexOf(c[i].id)==0){if(obj.checked){c[i].checked=true;}}}}function isMySonAllSelected(currID){var f=true;var c=document.getElementsByName(ystreecheckboxname);for(var i=0;i<c.length;i++){if(c[i].id!=currID&&c[i].id.indexOf(currID)==0){if(c[i].checked==false){f=false;break;}}}return f;}